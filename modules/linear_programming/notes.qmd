---
title: Linear Programming
---


### Linear Programming (LP) Structure

-   **Standard LP Form**:

    $$
    \max \; \pi'x \quad \text{s.t. } Ax \le b, \; x \ge 0
    $$

-   Characteristics:

    -   Linear objective.
    -   Linear constraints.
    -   Nonnegativity.

Can also be written in matrix notation.

**Economic interpretation:**

-   $\pi$: profit per unit.
-   $A$: resource use matrix.
-   $b$: resource endowment.

------------------------------------------------------------------------

### Model Building Process (McCarl framework)

1.  Identify **decision variables**.
2.  State the **objective**.
3.  Identify and formulate **constraints**.
4.  Collect data.
5.  Translate into computer-readable form.
6.  Solve and interpret.

--------------------

### Farm LP Example

A farmer has 500 acres of land available and is deciding how to allocate it between wheat and corn.
Each acre of wheat yields a profit of $200, requires 3 hours of labor, and 4 units of fertilizer.
Each acre of corn yields a profit of $300, requires 4 hours of labor, and 3 units of fertilizer.
The farm has at most 1,800 hours of labor available and 2,000 units of fertilizer.

Formulate this situation as a linear programming problem. Clearly define the decision variables,
write down the objective function representing total profit, and specify the constraints that capture
the land, labor, fertilizer, and nonnegativity restrictions.

**Decision variables.**  
Let $W$ = acres of wheat, $C$ = acres of corn.

### Scalar (algebraic) form
$$
\begin{aligned}
\max_{W,C}\quad 
& 200\,W + 300\,C \\
\text{s.t.}\quad 
& W + C \le 500 && \text{(land)}\\
& 3W + 4C \le 1800 && \text{(labor)}\\
& 4W + 3C \le 2000 && \text{(fertilizer)}\\
& W,\; C \ge 0~.
\end{aligned}
$$

### Matrix (compact) form
$$
\begin{aligned}
\max_{x\in\mathbb{R}^2_{\ge 0}}\quad 
& c^\top x \\
\text{s.t.}\quad 
& A x \le b,
\end{aligned}
\qquad
\text{with}\quad
x=\begin{bmatrix}W\\[2pt]C\end{bmatrix},\;
c=\begin{bmatrix}200\\[2pt]300\end{bmatrix},\;
A=\begin{bmatrix}
1 & 1\\
3 & 4\\
4 & 3
\end{bmatrix},\;
b=\begin{bmatrix}
500\\
1800\\
2000
\end{bmatrix}.
$$


-------------------------

## Summary

- Optimization = decision making under constraints.
- Mathematical programming provides a general framework: decision variables, objective, constraints.
- Linear programs (LPs): linear objective + linear constraints + nonnegativity.
- Example: Farm resource allocation with land, labor, fertilizer.



\newpage

## **Day 2: Linear Programming in Practice**

### Review
- General form of a mathematical program.
- Structure of a linear program:
  - Linear objective
  - Linear constraints
  - Nonnegativity
- Wheat–Corn farm allocation example in scalar and matrix notation.

---


### 7 Assumptions of Linear Programming

Linear programming models rely on a set of assumptions that make them tractable but also limit their realism. McCarl & Spreen (Ch. 2.4) identify **seven important assumptions**. The first three involve the *appropriateness of the formulation*; the last four describe *mathematical properties* of the LP model.

---

#### 1. Objective Function Appropriateness
- The objective function is assumed to be the **sole criterion** for evaluating solutions.  
- This means the decision maker’s preferences can be fully represented by a single linear function (e.g., profit, cost, utility).  
- In practice, decisions may depend on multiple objectives (profit, risk, leisure), but LP assumes one dominates.



#### 2. Decision Variable Appropriateness
- All relevant decision variables must be included, and each must be **fully controllable** by the decision maker.  
- Omitting key variables or including variables outside the decision maker’s control invalidates the formulation.



#### 3. Constraint Appropriateness
- Constraints must **accurately and completely capture** the limits faced by the decision maker:
  - They fully describe resource, technological, and institutional limits.  
  - Resources within a constraint are **homogeneous** and freely substitutable among activities.  
  - No constraint should arbitrarily rule out feasible choices.  
  - Constraints cannot be bent outside the model.



#### 4. Proportionality
- Contributions of activities to the objective function are **proportional** to their level.  
- Likewise, resource use is proportional: doubling an activity doubles its input use.  
- This rules out fixed costs, economies of scale, or price effects that depend on output level.



#### 5. Additivity
- Total contributions to the objective and resource use are the **sum of individual contributions**.  
- No interactions among variables are allowed (e.g., no multiplicative terms).  


#### 6. Divisibility
- Decision variables can take on **fractional values**.  
- This assumes continuous activities (e.g., acres of land).  
- When variables must be integer (e.g., number of tractors), integer programming is required instead.


#### 7. Certainty
- All parameters (objective coefficients, resource availability, input-output coefficients) are **known with certainty**.  
- LP is thus a deterministic model.  
- In practice, parameters are often estimated, and uncertainty can be explored with sensitivity or stochastic programming.



### Teaching Note
These assumptions both **enable LP to be solvable** and **limit realism**. They provide a natural segue to later topics in the course:

- Multi-objective programming (relax objective function assumption)  
- Integer programming (relax divisibility)  
- Stochastic programming (relax certainty)  
- Nonlinear programming (relax proportionality and additivity)

-----

### Graphical Solution Method (2 variables)

**Step 1. Draw the constraints.**

- Land: $W + C \le 500$
- Labor: $3W + 4C \le 1800$
- Fertilizer: $4W + 3C \le 2000$
- Nonnegativity: $W, C \ge 0$
- Plot based on endpoints. set one var 0 and devote all resources to that var.



```{r}
#| echo: false

xW <- seq(0, 500, by=1)
land_line <- 500 - xW

labor_line <- (1800 - 3*xW)/4

fertilizer_line <- (2000 - 4*xW)/3

library(ggplot2)

df <- data.frame(
  xW = xW,
  land = land_line,
  labor = labor_line,
  fert = fertilizer_line
)

vertices <- data.frame(
  xW = c(0, 0, 0, 200, 371, 500),
  xC = c(0, 500, 450, 300, 171, 0)
)

ggplot(df, aes(x=xW)) +
  geom_line(aes(y=land), color="blue") +
  geom_line(aes(y=labor), color="red") +
  geom_line(aes(y=fert), color="green") +
  geom_point(data=vertices, aes(x=xW, y=xC), size=3, color="black") +
  geom_text(data=vertices, aes(x=xW, y=xC, label=paste0("(",xW,",",xC,")")),
            hjust=-0.1, vjust=-0.5, size=3) +
  coord_cartesian(xlim=c(0,600), ylim=c(0,600)) +
  labs(x="Wheat",y="Corn")


```


**Step 2. Identify the feasible region.**

- Intersection of all constraints in the $(W, C)$ plane.
- Polygon bounded by lines.

**Step 3. Plot the objective function.**

- Profit = $200W + 300C$.
- Show isoprofit lines:
    - Suppose we plot \$6000 profit. All wheat no corn, then all corn no wheat.
    - lines of constant profit slope $-\tfrac{200}{300}=-\tfrac{2}{3}$.

**Step 4. Locate the optimum.**

- Slide the isoprofit line outward until the last point of contact with the feasible region.
- Optimum is always at a **corner point** (fundamental theorem of LP).

---

### Simplex Method

#### Why We Need It
- The graphical method only works for **two variables**.
- Real problems may involve **hundreds or thousands** of variables.
- Key geometric fact:  
  - The feasible region of an LP is a **convex polytope**.  
  - The **optimal solution lies at a vertex (corner point)**.  What about the problem makes this a fact?
- The simplex method provides a **systematic way** to move from vertex to vertex until the best one is found.

---

#### Core Idea
- Start at a **basic feasible solution (BFS)** — a corner point of the feasible region.
- At each step:
  1. Compute **reduced costs** (how much the objective improves if a variable increases from 0).
  2. Identify an **entering variable** (the candidate to increase).
  3. Determine which constraint binds first — this sets the **leaving variable**.
  4. **Pivot** to a new BFS.
- Stop when no variable can improve the objective — this is optimal.

---

### Intuition
- Simplex is like **walking along the edges** of the feasible polygon.
- At each corner, ask: *“If I move along this edge, does profit go up?”*
- Continue until no edge yields improvement.
- The same logic applies in higher dimensions, even though we cannot draw the polytope.

---

### Simplex Pivot — Tiny Worked Example

We use the smallest LP that still shows the mechanics:

**Problem**
$$
\begin{aligned}
\max\; & z = 3x_1 + 2x_2 \\
\text{s.t. }& x_1 + x_2 \le 4, \quad x_1 \le 2, \quad x_1,x_2 \ge 0.
\end{aligned}
$$

**Standard form (add slacks $s_1,s_2$)**



$$
\begin{aligned}
x_1 + x_2 + s_1 &= 4,\\
x_1 + s_2 &= 2,\\
z - 3x_1 - 2x_2 &= 0, \qquad s_1,s_2\ge 0.
\end{aligned}
$$
- Slack variables are added to “$\leq$” constraints to convert them into equalities, making the LP system compatible with the simplex algorithm.

- They measure the unused portion of a resource — e.g., if a land constraint is $x_1 + x_2 \leq 500$ and only 400 acres are used, the slack variable equals 100.

- Slack variables always have a zero coefficient in the objective function, since they do not directly contribute to profit or cost.

- Each slack variable typically appears with a coefficient of +1 in one constraint and 0 elsewhere, so they “fill the gap” between resource availability and resource use.

- At optimality, a nonzero slack indicates an unused resource. Checking which slack variables are positive helps interpret whether constraints are binding or loose.

---

### Initial tableau and choice of entering/leaving variables

**Initial Basic Feasible Solution (BFS):** $x_1=x_2=0 \Rightarrow s_1=4, s_2=2, z=0$.

**Tableau**
$$
\begin{array}{c|rrrr|r}
 & x_1 & x_2 & s_1 & s_2 & \text{RHS}\\\hline
s_1 & 1 & 1 & 1 & 0 & 4\\
s_2 & 1 & 0 & 0 & 1 & 2\\\hline
z   & -3 & -2 & 0 & 0 & 0\\
\end{array}
$$

- **Entering variable:** look at the objective row; most negative reduced cost is under $x_1$ (coefficient $-3$) → **enter $x_1$**.
- **Leaving variable (ratio test):** divide RHS by the positive entries in the $x_1$ column:  
  Row $s_1$: $4/1=4$, Row $s_2$: $2/1=2$. Minimum is 2 → **leave $s_2$**.
- **Pivot element:** the entry at row $s_2$, column $x_1$ (which is $1$).

We will **pivot on that 1**, swapping $s_2 \leftrightarrow x_1$.


### Row operations (make pivot column a unit vector)

Goal: pivot column $(x_1)$ should become $(0,1,0)^\top$.

1) **Normalize pivot row** (already 1, so no change):
$$
(s_2)\;:\;[\,1\;\;0\;\;0\;\;1\;|\;2\,].
$$

2) **Zero out the other entries in the $x_1$ column:**

- Row $s_1$: $(s_1) \leftarrow (s_1) - 1 \cdot (s_2)$
$$
[\,1\;\;1\;\;1\;\;0\;|\;4\,] - [\,1\;\;0\;\;0\;\;1\;|\;2\,]
= [\,0\;\;1\;\;1\;\;-1\;|\;2\,].
$$

- Row $z$: $(z) \leftarrow (z) + 3 \cdot (s_2)$
$$
[\,-3\;\;-2\;\;0\;\;0\;|\;0\,] + 3\cdot[\,1\;\;0\;\;0\;\;1\;|\;2\,]
= [\,0\;\;-2\;\;0\;\;3\;|\;6\,].
$$

---

### New tableau (after one pivot)

$$
\begin{array}{c|rrrr|r}
 & x_1 & x_2 & s_1 & s_2 & \text{RHS}\\\hline
s_1 & 0 & 1 & 1 & -1 & 2\\
\color{blue}{x_1} & 1 & 0 & 0 & 1 & 2\\\hline
z   & 0 & -2 & 0 & 3 & 6\\
\end{array}
$$

- **Basis after pivot:** $\{\,s_1,\;x_1\,\}$.  
- **Current solution:** $x_1=2,\; x_2=0,\; s_1=2,\; s_2=0,\; z=6$.  
- The column labels show that **$x_1$ entered** (blue row) and **$s_2$ left**.

**Next step (if continuing):** the most negative in the $z$-row is under $x_2$ (−2), so $x_2$ would enter next; the algorithm would pivot again and reach the optimum at $(x_1,x_2)=(2,2)$ with $z=10$.

![](simplex_example.png)

### Excel Solver

Excel implements the simplex method in the solver add-on. See [LP_land_alloc.xlxs](LP_land_alloc.xlsx)


### Summary
- Linear programming problems have:
  - **Decision variables** (choices to make),
  - **Objective function** (profit, cost, etc.),
  - **Constraints** (resource limits, requirements).
- Graphical method (2 variables) shows:
  - Feasible region = convex polygon.
  - Optimum occurs at a **corner point**.
- **Fundamental theorem of LP:** optimum is always at a vertex of the feasible region.
- **Simplex method** generalizes:
  - Moves systematically from one **basic feasible solution (BFS)** to another.
  - Uses **entering and leaving variables** to pivot.
  - Stops when no further improvement is possible.
- **Slack variables** convert inequalities to equalities and measure unused resources.
- Tableau row operations implement pivots (targeted Gaussian elimination).


## Sensitivity Analysis 

### Review
- LPs make 7 assumptions. What are a few?
- How do LPs algorithms solve? What is the fundamental theorem of LP?


### Motivation
- LPs give an **optimal solution** and an **objective value**.
- But: parameters (profits, resources, input requirements) are rarely known with certainty.
- We need to know how **robust** the solution is.

---

### What is Sensitivity Analysis?
- Also called **post-optimality analysis**.
- Asks: *how much can model parameters change before the current solution changes?*
- Focus on three categories:
  1. RHS (resources)  
  2. Objective coefficients (profits/costs)  
  3. Technical coefficients (input-output relationships)

---

### RHS (Right-Hand Side) Ranging
- Suppose resource availability changes:  
  $$b_{new} = b_{old} + \Delta r$$
- Current solution remains optimal **as long as basic variables stay $≥$ 0**. 
- Interpretation:
  - Within the allowable range, the **shadow price** is valid.
  - Outside the range, the optimal activity mix shifts.


---

### Objective Coefficient Ranging
- How much can a profit coefficient change before the basis changes?
- For **nonbasic variables**: reduced costs must remain $≥$ 0.
- For **basic variables**: check feasibility of objective row with new coefficient.


---

### Technical Coefficient Changes
- What if technology or input requirements change?
- Example: wheat now needs 3.5 instead of 3 labor hours per acre.
- Sensitivity analysis uses shadow prices to approximate the effect on objective value.
- Interpretation: tighter labor constraints may shift which crop dominates.

---

### The 100% Rule

The 100% Rule provides a way to evaluate whether simultaneous changes in objective function coefficients or right-hand side (RHS) values will preserve the current optimal basis — that is, whether the current solution remains optimal without re-solving the problem.

This rule applies separately to:
	
  - Changes in objective function coefficients (i.e., the $c_i$’s), and
  - Changes in the RHS values of constraints (i.e., the $b_j$’s).

---

Objective Function Coefficients

Suppose multiple objective coefficients change. For each decision variable $x_i$, let:
	
  -	$\Delta c_i$ be the change in the objective coefficient.
  -	$AL_i, AU_i$ be the allowable decrease and increase, respectively, as reported in the sensitivity analysis.

Define the proportion of the allowable range used for each change:

$$
r_i =
\begin{cases}
\frac{|\Delta c_i|}{AL_i} & \text{if } \Delta c_i < 0 \\
\frac{|\Delta c_i|}{AU_i} & \text{if } \Delta c_i > 0
\end{cases}
$$

Then, compute: $\sum_{i \in \text{changed vars}} r_i$. If: $\sum r_i \leq 1$, then the current optimal basis remains optimal, although the optimal value of the objective function will generally change. If the sum exceeds 1, the basis may change, and re-solving the problem is required.

---

### **Wheat–Corn Example (Excel Solver Report):**

#### Excel top panel: Variable Cells

Interpretation of columns:

- **Final Value** – the optimal level of the decision variable (e.g., acres of wheat or corn).
- **Reduced Cost** – for nonbasic variables (value = 0), how much the objective coefficient must improve before the variable would enter the solution. Zero if the variable is positive in the solution.
- **Objective Coefficient** – the profit (or cost) per unit used in the objective function.
- **Allowable Increase / Decrease** – the range over which the objective coefficient can change without altering the current optimal basis (solution structure).

Interpretation of results

- Corn: optimal solution plants 450 acres of corn. Reduced cost = 0 because it’s in the basis.
- Wheat: optimal solution plants 0 acres of wheat. Reduced cost = -25 means if wheat’s profit increased by more than $25/acre (from 200 → 225), it would enter the solution.

Ranges:

- Wheat: profit can increase up to +25 before wheat enters.
- Corn: profit can fall as much as 33.3 (300 → 266.7) before solution changes.
- Interpretation: Corn dominates under current prices. Wheat only becomes attractive if its relative profit improves substantially.

#### Excel bottom panel: Constraints

Interpretation of columns:

- **Final Value** – the amount of the resource actually used at the solution.
- **Constraint R.H. Side** – the available amount of the resource (the right-hand side of the inequality).
- **Shadow Price** – the marginal value of relaxing the constraint (increase in objective if RHS increases by 1 unit), valid only within the allowable range.
- **Allowable Increase / Decrease** – the range over which the shadow price remains valid and the current basis stays optimal.

Interpretation of results:

- Land: only 450 acres used out of 500. Slack = 50 acres. Shadow price = 0 because land is not binding. You can increase land indefinitely without improving profit (since labor is the true bottleneck).
- Labor: fully used (1800/1800). Shadow price = 75 means each additional labor hour would increase profit by $75, valid for up to +200 extra hours.
- Fertilizer: only 1350 units used of 2000. Slack = 650. Shadow price = 0 because it’s not binding.


**Economic Takeaways for Discussion**

- Which resource is scarce? Labor.
- How much should the agent be willing to pay for an additional unit of labor? 75 per labor hour. This is also the opportunity cost of labor on this operation.
- Why does wheat drop out of the solution? Because relative to corn it uses too much labor per profit dollar.
- Policy thought experiment: If labor availability were increased by 200 hours, profit would rise by $15,000 (200 × 75).

---

### Economic Interpretation
- **Shadow prices**: marginal value of resources.
- **Allowable ranges**: robustness of those shadow prices.
- **Managerial use**:  
  - Identify which resources are most binding.  
  - Assess which profit coefficients are critical.  
  - Evaluate new technologies or policy changes.

---

### Summary
- Sensitivity analysis extends LP results beyond a single point solution.
- Provides insight into:
  - Resource valuation (RHS changes),
  - Profit robustness (objective changes),
  - Technology shifts (coefficient changes).

---

## Getting Started with R & RStudio

### RStudio Orientation (2–3 min tour)

- **Source Pane (top-left):** where you edit scripts (`.R`) and notebooks (`.qmd`, `.Rmd`).
- **Console (bottom-left):** runs commands immediately (`>` prompt).
- **Environment/History (top-right):** objects in memory (data, vectors, functions).
- **Files/Plots/Packages/Help (bottom-right):** manage files, see plots, install packages, read docs.

**Workflow tips**

- Create a **Project** (`File → New Project…`) for the course; it pins your working directory.
- Put scripts in a `code/` folder, data in `data/`, and outputs in `out/`.
- Use **scripts** for anything you might need to re-run. Avoid one-off console work for assignments.

---

### Preview
- Next class: **duality** — formalize the relationship between primal and dual problems.
- Show how shadow prices emerge naturally from the dual formulation.


--------------------------

# Duality in Linear Programming

## Review

- Sensitivity analysis evaluates robustness of LP solutions to parameter changes.
- Shadow prices measure the marginal value of resources.
- Ranging analysis indicate how much parameters can change before the solution structure shifts.
- The 100% Rule helps assess simultaneous changes in parameters.
- Excel Solver provides a convenient way to solve LPs and get sensitivity reports.

## Motivation for Duality

- Duality provides a **theoretical foundation** for shadow prices.
- Every LP (the **primal**) has a corresponding **dual** LP.
- Solutions to the dual give the **shadow prices** of the primal constraints.
- Duality reveals deep connections between resources and values.
- Duality also aids in sensitivity analysis and economic interpretation.

---

## Canonical primal–dual pair

**Primal (max form, $≤$ constraints):**
$$
\begin{aligned}
\max_{x \ge 0}\quad & c^\top x \\
\text{s.t.}\quad & Ax \le b
\end{aligned}
$$

**Dual (min form, $≥$ constraints):**
$$
\begin{aligned}
\min_{y \ge 0}\quad & b^\top y \\
\text{s.t.}\quad & A^\top y \ge c
\end{aligned}
$$

**Rules of transformation (quick guide):**

- One **dual variable** per **primal constraint**; one **dual constraint** per **primal variable**.
- Primal “$a_i^T x \leq b_i$” with $x \ge 0$ → dual variable $y_i \ge 0$. Relaxing the RHS makes the feasible set bigger, so the dual variable (shadow price) must be nonnegative.
- Primal “$a_i^T x \geq b_i$” → dual variable $y_i \le 0$. Tightening the RHS makes the feasible set bigger (since it’s “$≥$”), so the associated price flips sign.
- Primal “$a_i^T x = b_i$” → dual variable $y$ **free** (unrestricted in sign). An equality can cut the feasible set in either direction, so the shadow price can be positive or negative.
- If a primal variable is **free**, the corresponding dual constraint is an **equality**; if primal variable has sign $x_j \le 0$, flip inequality accordingly.

---

## Wheat–Corn primal and its dual

**Primal (wheat–corn):**

$$
\begin{aligned}
\max\ & 200\,x_W + 300\,x_C\\
\text{s.t. } 
& x_W + x_C \le 500 && \text{(land)}\\
& 3x_W + 4x_C \le 1800 && \text{(labor)}\\
& 4x_W + 3x_C \le 2000 && \text{(fertilizer)}\\
& x_W,\ x_C \ge 0~.
\end{aligned}
$$

Introduce dual variables $y_1,y_2,y_3 \ge 0$ for (land, labor, fertilizer).  

**Dual:**

$$
\begin{aligned}
\min\ & 500\,y_1 + 1800\,y_2 + 2000\,y_3\\
\text{s.t. } 
& y_1 + 3y_2 + 4y_3 \ge 200 && \text{(wheat)}\\
& y_1 + 4y_2 + 3y_3 \ge 300 && \text{(corn)}\\
& y_1, y_2, y_3 \ge 0~.
\end{aligned}
$$

**Economic meanings:**  

$y_1$= land rent (per acre), $y_2$= wage (per labor hour), $y_3$= fertilizer value (per unit).

### Solve directly by intuition

A low-cost feasible choice is to try just one variable:

- Set $y_1=0,\, y_3=0$. The corn constraint gives $4y_2 \ge 300 \Rightarrow y_2 \ge 75$.
- Check wheat: $3y_2 \ge 200 \Rightarrow y_2 \ge 66.67$. So $y_2=75$ satisfies both.
- Dual objective: $500(0) + 1800(75) + 2000(0) = 135{,}000$.
- Could adding anything to $y_1$ or $y_3$ lower the cost? 
- No, because both constraints are already satisfied and any increase would only raise the objective.
- Feasibility check:
  - Wheat: $0 + 3(75) + 4(0) = 225 \ge 200$ 
  - Corn: $0 + 4(75) + 3(0) = 300 \ge 300$ 

**Let's verify in excel**

---

## Duality theorems 

### Weak duality 

For any feasible solution $x$ and $y$, 

$$c^\top x \le b^\top y$$

- From the primal constraints: $Ax \le b$
- From the dual constraints: $A^\top y \ge c$
- Premultiply the dual constraint by $x^\top \ge 0$: $x^\top A^\top y \ge x^\top c$ and note that $x^\top A^\top y = (Ax)^\top y$ 
- And post multiply the primal constraint by $y$: $(Ax)^\top y \le b^\top y$.
- Then putting the two together gives $c^\top x \leq x^\top A^\top y = (Ax)^\top y \leq b^\top y$.

Wheat-corn example:

- Primal feasible: $x_W=0, x_C=450 \Rightarrow Z=135{,}000$.
- Dual feasible: $y_1=0, y_2=75, y_3=0 \Rightarrow W=500(0)+1800(75)+2000(0)=135{,}000$.
- Weak duality holds: $135{,}000 \le 135{,}000$.


### Strong duality 

If the primal and dual have optimal solutions, so does the other, and $c^{\top} x^* = b^{\top} y^*$.

- At the optimum, the primal objective (profit) equals the dual objective (resource value).
- The upper bound becomes tight: best possible activity plan = best possible valuation of resources.
- Market analogy:
  - Primal: maximize profit given resource costs.
  - Dual: minimize resource costs to support given profits.
  - At equilibrium, profit = cost of resources.
  
- Wheat–corn example:  
  - Primal optimum: $Z^* = 135{,}000$.
  - Dual optimum: $500(0) + 1800(75) + 2000(0) = 135{,}000$
  


### Complementary slackness conditions

The **complementary slackness conditions** link the primal and dual solutions. They provide the bridge between activity levels and resource prices:

- For each **primal constraint** $a_i^\top x \le b_i$ with dual variable $y_i \ge 0$:
  $$
  y_i \,(b_i - a_i^\top x) = 0
  $$
  This means that either:
  - The constraint is **binding** ($a_i^\top x = b_i$) and then $y_i \ge 0$,  
  - Or the constraint is **slack** ($a_i^\top x < b_i$) and then $y_i = 0$.

- For each **primal variable** $x_j \ge 0$ with dual inequality $a_j^\top y \ge c_j$:
  $$
  x_j \,\big(a_j^\top y - c_j\big) = 0
  $$
  This means that either:
  - The activity is **produced** ($x_j > 0$) and then its dual inequality binds exactly ($a_j^\top y = c_j$),  
  - Or the activity is **not produced** ($x_j = 0$) and then the dual inequality can be slack ($a_j^\top y > c_j$).



# Summary

- Every LP has a corresponding dual LP.
- Dual variables represent shadow prices of primal constraints.
- Weak duality: primal objective $≤$ dual objective for any feasible solutions.
- Strong duality: at optimality, primal objective = dual objective.
- Complementary slackness links primal and dual solutions, indicating which constraints and variables are binding.
- Duality provides a theoretical foundation for sensitivity analysis and economic interpretation of LP results.


# Input–Output Modeling

## Motivation

- Economies are networks of interdependent sectors.  
- The output of one sector (e.g., steel) may be an input for another (e.g., car manufacturing).  
- Understanding these linkages helps us analyze how a change in demand or policy ripples through the entire economy.  
- Input–output (I–O) analysis was developed by **Wassily Leontief** (Nobel Prize, 1973).  

---

## Basic Input–Output Structure

- Consider an economy with $n$ sectors.  
- **Notation:**
  - $x_j$: total output of sector $j$.  
  - $a_{ij}$: units of good $i$ required as an intermediate input to produce one unit of good $j$.  
  - $f_j$: final demand for good $j$ (consumers, government, exports).  

- **Balance equation (sector $j$):**
  $$
  x_j = \sum_i a_{ij} x_j + f_j
  $$

- In vector notation:
  $$
  x = A x + f
  $$

where $A$ is the matrix of technical coefficients.

::: {.callout-note title="Productivity Condition in Input–Output Models"}
For the Leontief model
$$
x = A x + f \quad \Rightarrow \quad (I - A)x = f,
$$
the matrix $(I - A)$ must be invertible for a unique solution $x$ to exist.  
This requires that the **technical coefficient matrix $A$ be productive**.

- For each sector $j$, the column sum
  $$
  \sum_i a_{ij} < 1
  $$
  means that producing one unit of output $j$ uses **less than one unit of total inputs**.  

- Leaves some output available for **final demand** ($f_j > 0$).
- If $\sum_i a_{ij} = 1$, the industry just produces to sell to other industries.
- If $\sum_i a_{ij} > 1$, the industry is not productive - uses more resources than it produces.

**More formally:**  
The **spectral radius** (largest eigenvalue) of $A$ satisfies $\rho(A) < 1$.  
This guarantees $(I - A)^{-1}$ exists and the Leontief inverse is well-defined.

:::


---

## The Leontief Model

- Rearrange the balance equation:
  $$
  x - A x = f \quad \Rightarrow \quad   (I - A)x = f
  $$

- Provided $(I - A)$ is invertible:
  $$
  x = (I - A)^{-1} f
  $$

- The matrix $(I - A)^{-1}$ is called the **Leontief inverse**.  
- Interpretation: it captures both the **direct** and **indirect** requirements needed to meet final demand $f$.  
- Example: An increase in demand for cars requires more steel, which in turn requires more mining, etc.  

---

## Worked Example (3-sector economy)

Suppose three sectors: Agriculture (Ag), Manufacturing (M), and Services (S).  

- **Technical coefficient matrix** the fraction of output from each sector used as input by others:
  - Rows = input sectors (what is used).
  - Columns = output sectors (what is produced).
  - Entry $a_{ij}$ = units of input $i$ needed per unit of output $j$. Ag needs 30% of its own output, 20% from M, 10% from S, etc.
  
  $$
  A =
  \begin{bmatrix}
  0.3 & 0.2 & 0.1 \\
  0.1 & 0.4 & 0.2 \\
  0.2 & 0.1 & 0.3
  \end{bmatrix}
  $$


| Input /\ Output | Agriculture | Manufacturing | Services |
|----------------|-------------|---------------|----------|
| **Agriculture**    | 0.3         | 0.2           | 0.1      |
| **Manufacturing**  | 0.1         | 0.4           | 0.2      |
| **Services**       | 0.2         | 0.1           | 0.3      |



- Final demand vector:
  $$
  f =
  \begin{bmatrix}
  100 \\ 150 \\ 200
  \end{bmatrix}
  $$

- Solve:
  $$
  x = (I - A)^{-1} f
  $$

- Interpretation: The required outputs $x$ will be larger than $f$ because each sector’s output must also supply intermediates to others.  

```{r}
# Technical coefficients (3×3)
A <- matrix(c(0.3,0.2,0.1,
              0.1,0.4,0.2,
              0.2,0.1,0.3), nrow = 3, byrow = TRUE)

I3 <- diag(3)

# Leontief inverse (you can also pre-specify L as below)
L <- solve(I3 - A)

# Base final demand
f <- matrix(c(100,150,200), ncol = 1)

# Compute gross outputs
x <- L %*% f
round(x, 5)
```

---

## The Leontief Inverse and Multipliers

The matrix $(I - A)^{-1}$ is called the **Leontief inverse**.  
Each element of this matrix has an important interpretation: it measures the **total requirement** of one sector’s output needed to deliver one unit of final demand in another sector.

- The entry $(i,j)$ of $(I - A)^{-1}$ tells us:  “How many units of sector $i$ are needed, directly and indirectly, to produce one additional unit of final demand for sector $j$.”

- **Direct requirements:** given by $A$.  
  - Example: if $a_{12} = 0.2$, producing 1 unit of sector 2 requires 0.2 units of sector 1 directly.  

- **Indirect requirements:** captured through higher powers of $A$.  
  - $A^2$ shows inputs needed two steps back (e.g., steel needed to make machine tools, which then make cars).  
  - $A^3$ shows three-step linkages, and so on.  

- The series expansion makes this clear (Nuemann):
  $$
  (I - A)^{-1} = I + A + A^2 + A^3 + \cdots
  $$
  So the Leontief inverse accumulates all **direct and indirect linkages**.

### Multipliers

- A **multiplier** measures the total effect on the economy of a 1-unit increase in final demand for a given sector.  
- In practice, the multiplier for sector $j$ is the **column sum** of the $j$th column of $(I - A)^{-1}$.  
  - It tells us how much total output across all sectors must rise to support 1 more unit of $f_j$.  
- Sector-specific multipliers can also be read row by row:
  - The $i,j$ entry shows the effect on sector $i$ of a unit shock to demand in sector $j$.

### Example (2-sector economy)

Suppose
$$
A =
\begin{bmatrix}
0.2 & 0.1 \\
0.3 & 0.2
\end{bmatrix}, \quad
(I - A)^{-1} =
\begin{bmatrix}
1.27 & 0.16 \\
0.48 & 1.24
\end{bmatrix}.
$$

- A 1-unit increase in demand for sector 1 requires 1.27 units of sector 1 output and 0.48 units of sector 2 output in total.  
- Column sums: $1.27 + 0.48 = 1.75$.  
  - Interpretation: a 1-unit increase in final demand for sector 1 leads to 1.75 total units of output economy-wide (a multiplier of 1.75).  
- For sector 2, the multiplier is $0.16 + 1.24 = 1.40$.



**Takeaway:** The Leontief inverse is not just an algebraic trick — it directly encodes the multipliers that make input–output analysis such a powerful tool for tracing the effects of shocks.

---

## Assumptions of the Input–Output Model

- **Fixed input coefficients (Leontief technology)**  
  - Each sector uses inputs in fixed proportions.  
  - Example: if it takes 0.3 units of steel to make a car, every car always uses 0.3 units — no substitution is allowed.  

- **Constant returns to scale**  
  - Doubling output requires exactly double the inputs.  
  - There are no economies or diseconomies of scale.  

- **Linearity**  
  - Input requirements are linear in output.  
  - The balance equation $x = Ax + f$ is valid for all production levels.  

- **Homogeneous outputs**  
  - Each sector produces a single, uniform good.  
  - All uses of that good (whether as intermediate or final demand) are treated as identical.  

- **No supply constraints**  
  - Any level of final demand $f$ can, in principle, be met — resources are not limited.  
  - The model solves for required gross outputs without considering feasibility of factors like labor, land, or capital.  

- **Static technology and demand**  
  - The input coefficients $A$ are assumed constant over time (no innovation or efficiency change within the model run).  
  - The model is comparative static — it compares equilibria before and after shocks, not dynamic adjustment paths.  

- **Closed vs. open model treatment**  
  
  - In the “open” model, households are part of final demand.  
  - In the “closed” model, households are included as a sector that both consumes and supplies labor.  


## Input–Output Analysis in Practice

The input–output (I–O) model is usually used in a **calibration + shock** framework.  
Rather than solving an optimization problem, we work with observed data to trace how the economy responds to changes in demand or technology.

1. Calibration (Base Year)

- Construct the **technical coefficient matrix** $A$ from observed data:  
  $$a_{ij} = \frac{\text{input of $i$ used by $j$}}{\text{total output of $j$}}$$  
  - Data typically come from national input–output tables.  
- Observe base-year **final demand** $f$ (household consumption, government, exports).  
- Solve the identity
  $$
  x = Ax + f \quad \Rightarrow \quad x = (I-A)^{-1}f
  $$
  to check consistency with observed outputs $x$.  
- The calibrated model reproduces the base year exactly.

2. Apply a Shock

- Change final demand $f$:  
  - Example: +10 units of exports of manufacturing.  
- Or change technical coefficients $A$:  
  - Example: new technology reduces electricity needed in agriculture.  
- Or both.

3. Recompute Outputs

- Solve again:
  $$
  x' = (I-A)^{-1} f'
  $$
  where $f'$ is the new final demand (and possibly new $A$).  
- The difference $x'-x$ shows the **direct and indirect effects** of the shock.

4. Interpret Results

- Which sectors expand the most?  
- What are the **multipliers** (change in total output per unit change in final demand)?  
- How do shocks propagate across the economy?

---

**Example (illustrative):**  

- Suppose $f = (100, 150, 200)^\top$ and manufacturing exports rise by 20. And,  
$$
(I-A)^{-1} =
\begin{bmatrix}
1.6 & 0.6 & 0.4 \\
0.4 & 1.9 & 0.6 \\
0..5 & 0.4 & 1.6
\end{bmatrix}
$$

- Recalculate $x'$. 
- Agriculture and services expand too, even though their final demand did not change — because they supply inputs to manufacturing.


```{r}


# Shock: +20 to Manufacturing final demand
df <- matrix(c(0,20,0), ncol = 1)
f_prime <- f + df

# New outputs after shock
x_prime <- L %*% f_prime

# Change in outputs
dx <- x_prime - x

list(
  x = round(x, 5),
  x_prime = round(x_prime, 5),
  delta_x = round(dx, 5)
) 

# Manufacturing column of L (column 2)
L_col_M <- L[,2, drop=FALSE]
check_delta <- 20 * L_col_M

cbind(
  `20 * L[,2]` = round(check_delta, 5),
  `delta x`    = round(dx, 5)
)

```



This “calibrate + shock” procedure is the standard way input–output analysis is used in policy and research.

---

## Relation to LP

We can recast the input–output system as a linear program. This allows us to apply the LP tools we’ve already studied (primal, dual, shadow prices) to questions of production and pricing.

- **Primal problem (quantities).**  
  Decision variables are sector outputs $x_j$. The planner’s problem might be to:
  - *Minimize cost* of meeting a fixed vector of final demands $f$, subject to input–output balance, or  
  - *Maximize welfare* given resource or technology constraints.  

  The balance condition $x = Ax + f$ can be rearranged as  
  $$
  Ax + f \le x,
  $$
  meaning that each sector’s gross output must be at least enough to cover its intermediate input requirements ($Ax$) plus final demand ($f$).

- **Objective.**  
  A typical choice is to minimize the total value of inputs required to satisfy demand. For example:  
  $$
  \min \; c^\top x
  $$
  where $c$ is a vector of unit costs. Alternatively, if outputs are valued in welfare terms, the objective can be to maximize $v^\top f$.

- **Constraints.**  
  The inequalities $Ax + f \le x$ ensure feasibility: sectors cannot promise more intermediate and final goods than they can produce.

- **Dual problem (prices).**  
  The dual associates a variable $p_i$ with each balance constraint. These $p_i$ can be interpreted as **commodity prices** consistent with general equilibrium:  
  - If a commodity is scarce (constraint binding), its price is positive.  
  - If there is surplus, its shadow price falls to zero.  

- **Strong duality.**  
  At the optimum,
  $$
  \text{Value of outputs} = \text{Value of inputs}.
  $$
  In other words, the total revenue from selling goods at equilibrium prices equals the total cost of producing them using intermediate and primary inputs. This is the familiar condition for a competitive equilibrium in input–output economics.

---

Draw the parallels:

- *Primal* = “quantities world”: how much each sector produces to satisfy demands.  
- *Dual* = “prices world”: what set of commodity prices makes those quantities consistent with equilibrium.  
- Duality ensures these two views are perfectly consistent. 

---

## Applications in Economics

- **Environmental / Resource Economics**  
  - Trace carbon, water, or energy embodied in consumption.  
  - Assess land-use change from shifts in demand.  

- **Policy Analysis**  
  - Regional impact studies (IMPLAN, RIMS II).  
  - Tariff or trade shock analysis.  

- **Research extensions**  
  - Hybrid I–O and LP models for energy systems planning.  
  - Coupling I–O with CGE (computable general equilibrium) for price and income effects.  

---

## Classroom Activity

- Provide students with a small 2×2 $A$ matrix and demand vector $f$.  
- Ask them to compute:  
  1. $(I - A)$  
  2. $(I - A)^{-1}$  
  3. $x = (I - A)^{-1} f$  

- Discussion prompts:  
  - Which sector has the larger multiplier?  
  - What happens to required outputs if one coefficient $a_{ij}$ increases (e.g., manufacturing requires more agriculture)?  



