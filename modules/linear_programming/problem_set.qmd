---
title: "AREC 615 Problem Set: Linear Programming"
#format: pdf
---


This problem set covers the material from the introduction to linear programming through the simplex method, duality, and sensitivity analysis. Questions vary in difficulty and format. **Show your work and justify your answers.** Where appropriate, use R or Excel to solve the problems and include outputs as appendices.

---

# LP-by-hand and Interpretation (On Paper)

A small farm grows **heirloom tomatoes** and **bell peppers**.

- Each acre of tomatoes yields a **profit of \$60**, while each acre of peppers yields **\$40**.
- The farm has **8 acres** of suitable land available in total.
- Additionally, tomatoes require **twice as much irrigation** as peppers. Due to water availability, the total irrigation capacity is equivalent to **10 acre-units** of pepper irrigation.

Let:

- $x_1$ be the number of acres planted with tomatoes
- $x_2$ be the number of acres planted with peppers

Answer the following:

a. Formulate the linear program to maximize profit subject to the land and irrigation constraints. Define the decision variables, objective function, and constraints clearly.
b. Graph and indicate the feasible region and plot one of the isoprofit lines. Identify the optimal solution graphically.
c. Determine the optimal solution algebraically. What is the optimal objective value?
d. Identify the **binding** constraints at the optimum. 
e. Write out the tableau for the initial simplex method iteration.
f. Perform one pivot operation (select entering and leaving variables). Show the updated tableau. Continue iterating until the optimal solution is reached. Identify the optimal basis and solution values.
g. Compute the **shadow prices** (dual values) associated with the constraints. Interpret the shadow prices in economic terms.


# Distribution Optimization (Use Computer)

You are managing logistics for a food distribution network. There are **2 warehouses** (W1 and W2) and **5 cities** (C1 to C5) that need weekly shipments of food. Each warehouse can ship to each city â€” a total of **10 possible routes**. You want to meet the cities' demands at minimum cost while respecting warehouse capacities and various restrictions.

The **shipping cost per unit** from each warehouse to each city is shown below:

|       | C1 | C2 | C3 | C4 | C5 |
|-------|----|----|----|----|----|
| W1    | 4  | 6  | 8  | 7  | 5  |
| W2    | 5  | 4  | 7  | 6  | 6  |

Let $x_{ij}$ be the number of units shipped from warehouse $i$ to city $j$.

Each **city has a minimum demand** that must be met (in units):

- C1: 80, C2: 70, C3: 60, C4: 90, C5: 50

Each **warehouse has a maximum capacity** (in units):

- W1: 200, W2: 180

```{r}
#| echo: false
#| message: false
#| warning: false
library(igraph)
library(ggraph)
library(ggplot2)

# Define nodes
warehouses <- c("W1", "W2")
cities <- c("C1", "C2", "C3", "C4", "C5")
nodes <- data.frame(name = c(warehouses, cities),
                    type = c(rep("Warehouse", 2), rep("City", 5)))

# Define edges with costs
edges <- data.frame(
  from = rep(warehouses, each = 5),
  to = rep(cities, times = 2),
  cost = c(4, 6, 8, 7, 5, 5, 4, 7, 6, 6)
)

# Create igraph object
g <- graph_from_data_frame(edges, vertices = nodes, directed = TRUE)

# Create manual layout: W1 and W2 centered, cities on cost-proportional ring
angle <- seq(0, 2 * pi, length.out = length(cities) + 1)[-6]

layout_df <- data.frame(name = V(g)$name, x = 0, y = 0)

# Warehouses vertically centered
layout_df$x[layout_df$name == "W1"] <- 0
layout_df$y[layout_df$name == "W1"] <- 1
layout_df$x[layout_df$name == "W2"] <- 0
layout_df$y[layout_df$name == "W2"] <- -1

# Cities on circle, radius proportional to average cost
for (i in seq_along(cities)) {
  city <- cities[i]
  avg_cost <- mean(edges$cost[edges$to == city])
  radius <- avg_cost * 0.4
  layout_df$x[layout_df$name == city] <- radius * cos(angle[i])
  layout_df$y[layout_df$name == city] <- radius * sin(angle[i])
}

# Use create_layout() with manual layout
g_layout <- create_layout(g, layout = "manual", x = layout_df$x, y = layout_df$y)
g_layout <- create_layout(g, layout = "igraph",algorithm = "nicely")

# Plot
ggraph(g_layout) +
  geom_edge_link(aes(label = paste0("$", cost)),
                 angle_calc = 'along',
                 label_dodge = unit(2.5, 'mm'),
                 arrow = arrow(length = unit(4, 'mm')),
                 end_cap = circle(4, 'mm'),
                 start_cap = circle(4, 'mm'),
                 label_size = 3,
                 color = "gray40") +
  geom_node_point(aes(color = type), size = 8) +
  geom_node_text(aes(label = name), color = "black", size = 4) +
  scale_color_manual(values = c("Warehouse" = "skyblue", "City" = "salmon")) +
  theme_void() +
  ggtitle("Transportation Network") +
  theme(legend.position = "none")
```

---

a. **Formulate** this as a linear program:

  - Define all **decision variables**.
  - Write out the **objective function**.
  - Specify all **7 constraints** clearly. Don't forget the nonnegativity constraints.

b. **Solve** the model using R (e.g., `lpSolve`, `ompr`) or Excel Solver.

  - Report the optimal shipment plan and total cost.
  - Conduct a sensitivity analysis including ranging analysis on the objective coefficients and  constraints.
  - Insert a table summarizing the sensitivity analysis results.
  - Provide your code or spreadsheet setup in an appendix.

c. **Interpret** the dual values (shadow prices) for the city demand constraints.

  - Generate a table showing the shadow prices for all constraints.
  - What do the shadow price tell you? Imagine explaining to a non-technical manager.
  - If you could increase the capacity of one warehouse by 10 units, which one would you choose and why?

d. Suppose you could build a new warehouse with a capacity of 100 units at a fixed cost.

  - Which cities should it serve to minimize total costs?
  - Modify the LP to include this new warehouse and solve. You can make up new shipping costs.
  - Re-solve and explain how the solution changes.
  - Can you use your results to provide guidance on the amount the company should be willing to pay for the new warehouse?

---

# Dual Formulation and Interpretation

Consider the following primal LP:

$$
\begin{aligned}
\max \quad & 100x_1 + 150x_2 \\
\text{s.t.} \quad 
& x_1 + 2x_2 \le 10 \\
& 3x_1 + x_2 \le 12 \\
& x_1, x_2 \ge 0
\end{aligned}
$$

a. Formulate the **dual** problem.

b. Solve the **dual** using R or Excel. What are the optimal dual variable values?

c. Verify **strong duality**: does the optimal value of the dual match the primal?

d. Check **complementary slackness**. Which constraints are binding, and how does this relate to the dual?

